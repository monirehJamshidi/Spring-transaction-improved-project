# Spring-transaction-improved-project


[๐ฌ๐ง English](./README.md)

๐ท Transaction ุฏุฑ Spring ฺุณุชุ

ุฑุงฺฉูุด (Transaction) ูุฌููุนูโุง ุงุฒ ุนููุงุช ุงุณุช ฺฉู ุจุงุฏ ููู ุจุง ูู ูููู ุดููุฏ ุง ููู ุจุง ูู ุดฺฉุณุช ุจุฎูุฑูุฏ. ุนู Atomicity.

ูุซูุงู:

- ูพูู ุงุฒ ุญุณุงุจ A ฺฉู ูโุดูุฏุ
- ูพูู ุจู ุญุณุงุจ B ุงุถุงูู ูโุดูุฏ.
- ุงฺฏุฑ ุฏูู ูููู ูุดูุฏุ ุงูู ูู ุจุงุฏ ุจุฑฺฏุฑุฏุฏ.

Spring ุงู ุฑูุชุงุฑ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ Spring Transaction Management ูุฑุงูู ูโฺฉูุฏ.

๐ท ฺุฑุง ุงุฒ Transaction ุงุณุชูุงุฏู ูโฺฉููุ

4 ูฺฺฏ ุงุตู Transaction (ACID):
1. Atomicity โ ุนููุงุช ุง ฺฉุงูู ุงูุฌุงู ูโุดูุฏ ุง ุงุตูุงู ุงูุฌุงู ููโุดูุฏ.

2. Consistency โ ูพุงฺฏุงูโุฏุงุฏู ุฏุฑ ูุถุนุช ูุนุชุจุฑ ูโูุงูุฏ.

3. Isolation โ ุชุฑุงฺฉูุดโูุง ุฑู ูู ุชุฃุซุฑ ูฺฏุฐุงุฑูุฏ.

4. Durability โ ุจุนุฏ ุงุฒ commit ุดุฏูุ ุฏุงุฏูโูุง ูพุงุฏุงุฑูุฏ.

๐ท ูููโุชุฑู Annotation: @Transactional

ู Spring ุจุง ุงู Annotation ุชุฑุงฺฉูุดโูุง ุฑุง ฺฉูุชุฑู ูโฺฉูุฏ.

    @Service
    public class PaymentService {

        @Transactional
        public void transferMoney() {
            accountRepository.decrease(1, 100);
            accountRepository.increase(2, 100);
        }
    }


ุงฺฏุฑ ูุฑ ฺฉุฏุงู ุงุฒ ุนููุงุช ุฎุทุง ุจุฏูุฏุ ฺฉู ุชุฑุงฺฉูุด rollback ูโุดูุฏ.

๐ท ุฑูุชุงุฑ ูพุดโูุฑุถ @Transactional
โ ุงฺฏุฑ RuntimeException ุง Error ุฑุฎ ุฏูุฏ โ Rollback
โ ุงฺฏุฑ checked exception ุฑุฎ ุฏูุฏ โ Rollback ููโุดูุฏ (ูฺฏุฑ ุงูฺฉู ุฎูุฏุช ูุดุฎุต ฺฉู)


๐ถ ุงฺฏุฑ ุจุฎูุงู ุจุฑุง Exceptionโูุง ุฎุงุต Rollback ุงูุฌุงู ุดูุฏ:

    @Transactional(rollbackFor = Exception.class)
    public void doSomething() { }


๐ท Propagation ฺุณุชุ
Propagation ุชุนู ูโฺฉูุฏ ุงฺฏุฑ ฺฉ ูุชุฏ Transactional ุฏุฑ ุฏุงุฎู ฺฉ ุชุฑุงฺฉูุด ููุฌูุฏ ุตุฏุง ุฒุฏู ุดูุฏุ ุฑูุชุงุฑ ุขู ฺฺฏููู ุจุงุดุฏ.
ูููโุชุฑู ุญุงูุชโูุง:

1๏ธโฃ REQUIRED (ูพุดโูุฑุถ)
ุงฺฏุฑ ุชุฑุงฺฉูุด ูุฌูุฏ ุฏุงุฑุฏ โ ููุงู ุฑุง ุงุฏุงูู ุจุฏู
ุงฺฏุฑ ูุฌูุฏ ูุฏุงุฑุฏ โ ฺฉ ุชุฑุงฺฉูุด ุฌุฏุฏ ุจุณุงุฒ

2๏ธโฃ REQUIRES_NEW
ุชุฑุงฺฉูุด ูุนู ุฑุง ูุชููู ูโฺฉูุฏ ู ฺฉ ุชุฑุงฺฉูุด ฺฉุงููุงู ุฌุฏุฏ ุงุฌุงุฏ ูโฺฉูุฏ.

3๏ธโฃ MANDATORY
ุญุชูุงู ุจุงุฏ ุฏุฑูู ุชุฑุงฺฉูุด ุตุฏุง ุฒุฏู ุดูุฏุ ูฺฏุฑูู Exception ูโุฏูุฏ.

4๏ธโฃ SUPPORTS
ุงฺฏุฑ ุชุฑุงฺฉูุด ููุฌูุฏ ุจุงุดุฏ โ ุงุณุชูุงุฏู ูโฺฉูุฏ
ุงฺฏุฑ ูุจุงุดุฏ โ ุจุฏูู ุชุฑุงฺฉูุด ุงุฏุงูู ูโุฏูุฏ

5๏ธโฃ NOT_SUPPORTED
ุงฺฏุฑ ุชุฑุงฺฉูุด ุจุงุดุฏ โ ุขู ุฑุง ุชุนูู ูโฺฉูุฏ

6๏ธโฃ NEVER
ุงฺฏุฑ ุชุฑุงฺฉูุด ูุนุงู ุจุงุดุฏ โ Exception

7๏ธโฃ NESTED
ุชุญุช ุชุฑุงฺฉูุด ูุงูุฏ ุงุฌุฑุง ูโุดูุฏ ูู ูุงุจูุช rollback ูุณุชูู ุฏุงุฑุฏ (savepoint).



๐ท Isolation Levels

ูุดุฎุต ูโฺฉูุฏ ุชุฑุงฺฉูุด ฺู ุณุทุญ ุงุฒ ุฌุฏุงุณุงุฒ ุฏุงุฏูโูุง ุฏุงุดุชู ุจุงุดุฏ. ุฌููฺฏุฑ ุงุฒ ูุดฺฉูุงุช ูุซู:
- Dirty Read
- Non-repeatable Read
- Phantom Read

ูููโุชุฑู ุณุทูุญ:
| Level            | ุชูุถุญ                                                 |
| ---------------- | ----------------------------------------------------- |
| READ_UNCOMMITTED | ุถุนูโุชุฑูุ ุงุฌุงุฒู dirty read                           |
| READ_COMMITTED   | ุจุดุชุฑ DBูุงุ ุฌููฺฏุฑ ุงุฒ dirty read                     |
| REPEATABLE_READ  | ูพุงุฏุงุฑ ุจุฑุง ุฎูุงูุฏูุ ุฌููฺฏุฑ ุงุฒ dirty ู non-repeatable |
| SERIALIZABLE     | ููโุชุฑูุ ฺฉูุฏุชุฑู                                     |


ูุซุงู:

    @Transactional(isolation = Isolation.REPEATABLE_READ)
    public void doSomething() { }


๐ท ูฺฉุชู ุจุณุงุฑ ููู ุฏุฑ ูุตุงุญุจู:

โ ฺุฑุง @Transactional ุฑู private ูุชุฏ ฺฉุงุฑ ููโฺฉูุฏุ
ฺูู Spring Transaction ุจุง Proxy ฺฉุงุฑ ูโฺฉูุฏ

ู ููุท calls from outside class ุฑุง intercept ูโฺฉูุฏ.
ูุซูุงู:

    public class Test {

        @Transactional
        public void a() {
            b(); // ุงู ุชุฑุงฺฉูุด ุฑุง ูุนุงู ููโฺฉูุฏ
        }

        @Transactional
        private void b() {  }
    }

ุงฺฏุฑ ูุชุฏ b() ุฑุง ุงุฒ ุฏุงุฎู ููุงู ฺฉูุงุณ ุตุฏุง ุจุฒู โ Proxy ุฏุฑ ฺฉุงุฑ ูุณุช โ @Transactional ุงุนูุงู ููโุดูุฏ.

๐ท Rollback ุฏุณุช

ุงฺฏุฑ ุฎูุงุณุช ุฏุณุช Rollback ฺฉู:

    @Transactional
    public void work() {
    TransactionAspectSupport.currentTransactionStatus().setRollbackOnly();
    }
